# 反射

### 什么是反射

反射是在运行过程中，对于任意一个类都能够知道这个类所有属性和方法；对于任意一个对象，都能够调用他的任意方法和属性的动态获取信息和动态调用对象方法的功能称为Java的反射。

### 代码演示

在本例子中，我们新建一个具有多个属性的类作为我们反射所操作的对象。

```java
package reflection;

import lombok.Data;

/**
 * @author: chenlei
 * @date: 17:28 2020/6/12
 **/
@Data
public class Book {
    private final static String TAG = "BookTag";


    private String name;
    private String author;

    public Book(){}
    public Book(String name,String author){
        this.name = name;
        this.author = author;
    }

    public private getInfo(){
        return "Name:" + name + ",author:" + author;
    }
    public String getName() {
        return this.name;
    }
}

```

编写反射操作类来获取类的属性。

```java
package reflection;


import java.lang.reflect.Field;
import java.lang.reflect.InvocationTargetException;
import java.lang.reflect.Method;

/**
 * @author: chenlei
 * @date: 17:46 2020/6/12
 **/
public class ReflectUnit {
    //创建对象
    public static Book instanceBook() {
        try {
            Class<?> classBook = Class.forName("reflection.Book");
            //newInstance()方法已经弃用，应该使用如下方法来生成对象
            Object objectBook = classBook.getDeclaredConstructor().newInstance();
            Book book = (Book)objectBook;
            book.setAuthor("鲁迅");
            book.setName("呐喊");
            System.out.println("class"+book.toString());
            return book;
        } catch (IllegalAccessException e) {
            e.printStackTrace();
        } catch (InstantiationException e) {
            e.printStackTrace();
        } catch (ClassNotFoundException e) {
            e.printStackTrace();
        } catch (NoSuchMethodException e) {
            e.printStackTrace();
        } catch (InvocationTargetException e) {
            e.printStackTrace();
        }
        return null;
    }

    //反射属性
    public static void reflectField(Book book,String field) {
        try {
            Class<?> classBook = Class.forName("reflection.Book");
            Field fieldTag = classBook.getDeclaredField(field);
            fieldTag.setAccessible(true);
            String name = (String)fieldTag.get(book);
            System.out.println("name:" + name);
        } catch (IllegalAccessException e) {
            e.printStackTrace();
        } catch (NoSuchFieldException e) {
            e.printStackTrace();
        } catch (ClassNotFoundException e) {
            e.printStackTrace();
        }
    }
    //反射方法
    public static void reflectMethod(Book book,String m) {
        try {
            Class<?> classBook = Class.forName("reflection.Book");
            Method method = classBook.getMethod(m);
            method.setAccessible(true);
            String s = (String) method.invoke(book);
            System.out.println("method:" + s);
        } catch (InvocationTargetException e) {
            e.printStackTrace();
        } catch (NoSuchMethodException e) {
            e.printStackTrace();
        } catch (IllegalAccessException e) {
            e.printStackTrace();
        } catch (ClassNotFoundException e) {
            e.printStackTrace();
        }
    }

    public static void main(String[] args) {
        Book book = instanceBook();
        reflectField(book,"name");
        reflectMethod(book,"getInfo");
    }
}
```

输出结果

```
classBook(name=呐喊, author=鲁迅)
name:呐喊
method:Name:呐喊,author:鲁迅
```

可以看到我们通过反射新建了对象，获取了对象的私有属性以及私有方法。以上就是反射的基本用法。

